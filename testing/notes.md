# Тестирование

## Unit-тестирование, модульное тестирование

"Процесс в программировании, позволяющий проверить на корректность
отдельные модули исходного кода программы, наборы из одного или более
программных модулей вместе с соответствующими управляющими данными,
процедурами использования и обработки. Идея состоит в том, чтобы
**писать тесты** для каждой нетривиальной функции или метода."

Идея простая: в тестирующих функциях вызываются тестируемые функции и
проверяется результат.

В [примере 1](example/handy.py) приведена реализация без использования
специальных средств. Достоинство - универсальность. Что-то такое можно
реализовать на любом языке программирования.

Недостатки:

* Тестирующие функции никак не сгруппированы
* Записи в отчет о тестировании приходится формировать вручную
* Громоздкость проверки, особенно в тех случаях, когда надо проверить
  исключение
* Невыразительность выражений, в которых происходит проверка
* Затруднено управление содержимым отчета о тестировании. Иногда нужно
  видеть результат выполнения каждого теста, а иногда достаточно
  информации о том, что все тесты пройдены успешно и детали только
  мешают.

Но, даже проводя рефакторинг данного примера, можно прийти к
реализации своей библиотеки для unit-тестирования.

Такая библиотека уже есть. Это `unittesting`. Для многих языков есть
такие библиотеки.

[Вот](ut.py) тот же самый пример с использованием библиотеки
`unittesting`. Сравните.

Запуск:

```
$ python3 -v ut.py
```

Опция `-v` позволяет вывести подробный отчет о тестировании.

## Пример

[Пример](security)

Задача. Требовалось разработать компонент аутентификации (упрощенный,
учебный, игрушечный) пользователей в некоторой системе. Функционал:
управление перечнем учетных записей, проверка правильности имени
пользователя и пароля.

Решалась задача в технике `TDD`. Прежде чем приступить к добавлению
очередной функциональности, добавлялся тест, покрывающий будущую
функциональность.

Класс `Passwd` содержит методы, реализующие требуемую
функциональность.

Класс `User` представляет информацию об одной учетной записи.

Класс `DataDriver` представляет абстрактное хранилище данных. От этого
класса наследуются конкретные реализации. Все, что можно сделать с
хранилищем - записать и прочитать данные.

Класс `StubDataDriver` - это конкретное хранилище данных. Все, что в
него записывается, хранится в оперативной памяти. Это нужно для того,
чтобы проще тестировать основную функциональность, избегая неудобств,
связанных с проверкой содержимого реальных файлов, удаления их и
т.п. Впрочем, вместо этого можно было использовать механизм временных
файлов.

Класс `TestPasswd` - это набор тестов.

Запуск процесса тестирования. В папке `security` надо выполнить:

```
$ python3 test_passwd.py
```

или

```
> py test_paswd.py
```

в зависимости от операционной системы.

## Ссылки

* [Модульное тестирование](https://ru.wikipedia.org/wiki/%D0%9C%D0%BE%D0%B4%D1%83%D0%BB%D1%8C%D0%BD%D0%BE%D0%B5_%D1%82%D0%B5%D1%81%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5)
* [Модуль unittest: тестируем свои программы](https://pythonworld.ru/moduli/modul-unittest.html)
* [unittest — Unit testing framework](https://docs.python.org/3/library/unittest.html)
* [Разработка через тестирование](https://ru.wikipedia.org/wiki/%D0%A0%D0%B0%D0%B7%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D0%BA%D0%B0_%D1%87%D0%B5%D1%80%D0%B5%D0%B7_%D1%82%D0%B5%D1%81%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5)
* [ TDDx2, BDD, DDD, FDD, MDD и PDD, или все, что вы хотите узнать о Driven Development ](https://habr.com/ru/post/459620/)
